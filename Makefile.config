# Do not modify this file! Add a Makefile.local (or export envvars) instead.

ROOTDIR ?= $(shell realpath .)

-include $(ROOTDIR)/Makefile.local

# Toolchain options
OSNAME ?= k-os
TOOLCHAINPREFIX ?= build
TARGET ?= i586-elf
BINUTILS_VER ?= 2.27
GMP_VER      ?= 6.1.1
MPFR_VER     ?= 3.1.5
MPC_VER      ?= 1.0.3
GCC_VER      ?= 6.2.0

# Util names
UTILBINPREFIX ?= bin
MKROOTRAMFS ?= mkrootramfs

# Main binary output file names
LIBCAR ?= libc.a
KBINARY ?= kernel.elf
ROOTRAMFS ?= rootramfs
IMAGE ?= cdrom.iso
HDD ?= hdd.img

# Emulation options
QEMU ?= qemu-system-i386
CORES ?= 8

########### ABSOLUTELY DO NOT MODIFY BELOW YOU RISK DATA CORRUPTION! ###########
# Calculated constants
TOOLCHAINDIR ?= $(ROOTDIR)/toolchain
UTILDIR ?= $(ROOTDIR)/util
LIBDIR ?= $(ROOTDIR)/libc
KERNELDIR ?= $(ROOTDIR)/kernel
APPSDIR ?= $(ROOTDIR)/apps
DISTDIR ?= $(ROOTDIR)/dist

TOOLCHAINBINDIR := $(TOOLCHAINDIR)/$(TOOLCHAINPREFIX)
UTILBINDIR := $(UTILDIR)/$(UTILBINPREFIX)

QEMUARGS ?= -smp cores=$(CORES) -boot d -cdrom $(DISTDIR)/$(IMAGE) -drive id=disk,format=raw,file=$(HDD),if=none -device ahci,id=ahci -device ide-drive,drive=disk,bus=ahci.0 -netdev user,id=network0 -device e1000,netdev=network0

# Required tools
WGET ?= wget
TAR ?= tar
KAR := $(TOOLCHAINBINDIR)/bin/$(TARGET)-ar
KAS := $(TOOLCHAINBINDIR)/bin/$(TARGET)-as
KLD := $(TOOLCHAINBINDIR)/bin/$(TARGET)-ld
KCPP := $(TOOLCHAINBINDIR)/bin/$(TARGET)-cpp
KCC := $(TOOLCHAINBINDIR)/bin/$(TARGET)-gcc
